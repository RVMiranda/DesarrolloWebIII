global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'parcial1'
    environment: 'development'

# Alertmanager (opcional, descomentar si lo usas)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: ['alertmanager:9093']

scrape_configs:
  # Métricas del backend FastAPI
  - job_name: "fastapi"
    static_configs:
      - targets: ["calculadora:8000"]
        labels:
          service: "backend"
          environment: "parcial1"
    
    # Métricas específicas de FastAPI (si tienes prometheus_client)
    metrics_path: '/metrics'
    scrape_interval: 10s
  
  # Auto-monitoreo de Prometheus
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]
        labels:
          service: "prometheus"
  
  # Métricas de Loki
  - job_name: "loki"
    static_configs:
      - targets: ["loki:3100"]
        labels:
          service: "loki"
  
  # Métricas de Promtail
  - job_name: "promtail"
    static_configs:
      - targets: ["promtail:9080"]
        labels:
          service: "promtail"
  
  # Métricas de MongoDB (si expones métricas)
  - job_name: "mongodb"
    static_configs:
      - targets: ["mongo:27017"]
        labels:
          service: "mongodb"
    scrape_interval: 30s